{"sourceFilePath":"C:\\Source\\Demos\\testing-javascript\\mutations\\generic-diff.js","mutatorName":"BlockStatement","status":1,"replacement":"{\n}","location":{"start":{"line":12,"column":31},"end":{"line":209,"column":1}},"range":[490,7620],"testsRan":["Array Group By grouping an empty array should return empty result","Array Group By one item array should result in one group","Array Group By two items with different keys should result in two group","Array Group By two items with same keys should result in one group","Array Group By five items should properly be grouped in two groups","Array Group By even and odd numbers should be properly separated","Array Group By group-reducing an empty array should return empty result","Array Group By one item array should result in one group with ignoring reducer","Array Group By one item array should result in one group with summing reducer","Array Group By two items with different keys should result in two group with ignoring reducer","Array Group By two items with different keys should result in two group with summing reducer","Array Group By two items with same keys should result in one group with ignoring reducer","Array Group By two items with same keys should result in one group with summing reducer","Array Group By five items should properly be grouped in two groups with ignoring reducer","Array Group By five items should properly be grouped in two groups with summing reducer","Array Group By even and odd numbers should be properly separated and reduced (summing reducer)","Array Group By even and odd numbers should be properly separated and reduced (multiplying reducer)","Array Group By even and odd numbers should be properly separated and reduced (object reducer)","Array Group By even and odd numbers should be properly separated and reduced (array reducer)","Generic difference calculator verifies that generic diff of two undefineds returns that nothing is changed","Generic difference calculator verifies that generic diff of undefined and value returns that value is Added","Generic difference calculator verifies that generic diff of value and undefined returns that value is Removed","Generic difference calculator verifies that generic diff of two nulls returns that nothing is changed","Generic difference calculator verifies that generic diff of null and value returns that value is Added","Generic difference calculator verifies that generic diff of value and null returns that value is Removed","Generic difference calculator verifies that generic diff of undefined and null returns that value is Modified","Generic difference calculator verifies that generic diff of null and undefined returns that value is Modified","Generic difference calculator verifies that generic diff of string and number returns that value is TypeChanged","Generic difference calculator verifies that two objects with same properties in the same order result in an unchanged result","Generic difference calculator verifies that two complex objects with same properties in the same order result in an unchanged result","Generic difference calculator verifies that two objects with same properties in different order result in an unchanged result","Generic difference calculator verifies that two complex objects with same properties in different order result in an unchanged result","Generic difference calculator verifies that two objects with same properties, different values in the same order result in an Modified result","Generic difference calculator verifies that two complex objects with same properties with different outer values in different order result in an correct modified result","Generic difference calculator verifies that two complex objects with same properties with different inner values in different order result in an correct modified result","Generic difference calculator verifies that two objects with different properties result in an Modified result","Generic difference calculator verifies that array / object comparison results in a TypeChanged result","Generic difference calculator verifies that object / array comparison results in a TypeChanged result","Generic difference calculator verifies that two arrays with same primitive values result in an unchanged result","Generic difference calculator verifies that two arrays, where the old has less elements will result in a Added result","Generic difference calculator verifies that two arrays, where the old has more elements will result in a Removed result","Generic difference calculator verifies that two arrays with same complex values result in an unchanged result","Generic difference calculator verifies that two arrays with same complex values (different property order) result in an unchanged result","Generic difference calculator verifies that two arrays with different primitive values result in an modified result","Generic difference calculator verifies that two arrays with payload changes detects changes using key extractors","Generic difference calculator verifies that two objects with array properties with payload changes detects changes using key extractors"],"originalLines":"var GenericDiff = (function () {\r\n    function GenericDiff() {\r\n    }\r\n    GenericDiff.getDifference = function (oldValue, newValue, name, keyExtractors) {\r\n        var left = oldValue;\r\n        var right = newValue;\r\n        // handle undefined values\r\n        if (left === undefined) {\r\n            if (right === undefined) {\r\n                return {\r\n                    oldValue: undefined,\r\n                    newValue: undefined,\r\n                    changeType: DiffType.Unchanged\r\n                };\r\n            }\r\n            return {\r\n                oldValue: undefined,\r\n                newValue: right,\r\n                changeType: right === null ? DiffType.Modified : DiffType.Added\r\n            };\r\n        }\r\n        if (right === undefined) {\r\n            return {\r\n                oldValue: left,\r\n                newValue: undefined,\r\n                changeType: left === null ? DiffType.Modified : DiffType.Removed\r\n            };\r\n        }\r\n        // handle null values\r\n        if (left === null) {\r\n            if (right === null) {\r\n                return {\r\n                    oldValue: null,\r\n                    newValue: null,\r\n                    changeType: DiffType.Unchanged\r\n                };\r\n            }\r\n            return {\r\n                oldValue: null,\r\n                newValue: right,\r\n                changeType: DiffType.Added\r\n            };\r\n        }\r\n        if (right === null) {\r\n            return {\r\n                oldValue: left,\r\n                newValue: null,\r\n                changeType: DiffType.Removed\r\n            };\r\n        }\r\n        // handle base types\r\n        var leftType = typeof left;\r\n        var rightType = typeof right;\r\n        if (leftType !== rightType) {\r\n            return {\r\n                oldValue: oldValue,\r\n                newValue: newValue,\r\n                changeType: DiffType.TypeChanged\r\n            };\r\n        }\r\n        // are they primitives?\r\n        if (leftType !== \"object\") {\r\n            return {\r\n                oldValue: left,\r\n                newValue: right,\r\n                changeType: (left === right) ? DiffType.Unchanged : DiffType.Modified\r\n            };\r\n        }\r\n        // base case - are their serializations equal\r\n        var leftJson = JSON.stringify(left);\r\n        var rightJson = JSON.stringify(right);\r\n        if (leftJson === rightJson) {\r\n            return {\r\n                oldValue: left,\r\n                newValue: right,\r\n                changeType: DiffType.Unchanged\r\n            };\r\n        }\r\n        // the values are objects, and they have different serializations\r\n        // are they arrays?\r\n        if (Array.isArray(left)) {\r\n            if (Array.isArray(right)) {\r\n                return (this.getArrayDifference(left, right, name, keyExtractors));\r\n            }\r\n            else {\r\n                return {\r\n                    oldValue: left,\r\n                    newValue: right,\r\n                    changeType: DiffType.TypeChanged\r\n                };\r\n            }\r\n        }\r\n        if (Array.isArray(right)) {\r\n            return {\r\n                oldValue: left,\r\n                newValue: right,\r\n                changeType: DiffType.TypeChanged\r\n            };\r\n        }\r\n        // compare object properties by name\r\n        var allKeyNames = Object.keys(left).concat(Object.keys(right));\r\n        var result = {\r\n            oldValue: left,\r\n            newValue: right,\r\n            changeType: DiffType.Uncomparable\r\n        };\r\n        for (var index = 0; index < allKeyNames.length; index += 1) {\r\n            var propName = allKeyNames[index];\r\n            var diff = this.getDifference(left[propName], right[propName], propName, keyExtractors);\r\n            if (diff.changeType !== DiffType.Unchanged) {\r\n                result[propName] = diff;\r\n            }\r\n        }\r\n        // are there any changes\r\n        if (allKeyNames.some(function (key) { return result[key] && result[key].changeType !== DiffType.Unchanged; })) {\r\n            result.changeType = DiffType.Modified;\r\n            return result;\r\n        }\r\n        return {\r\n            oldValue: left,\r\n            newValue: right,\r\n            changeType: DiffType.Unchanged\r\n        };\r\n    };\r\n    GenericDiff.getArrayDifference = function (leftArray, rightArray, name, keyExtractors) {\r\n        var addedItems = rightArray.slice();\r\n        var unchangedItems = [];\r\n        var removedItems = [];\r\n        var changedItems = [];\r\n        if (keyExtractors && keyExtractors[name]) {\r\n            // we're using key matching\r\n            var keyGetter_1 = keyExtractors[name];\r\n            var _loop_1 = function (lindex) {\r\n                var litem = leftArray[lindex];\r\n                var lkey = keyGetter_1(litem);\r\n                var rindex = addedItems.findIndex(function (r) { return keyGetter_1(r) === lkey; });\r\n                var ritem = addedItems[rindex];\r\n                if (!ritem) {\r\n                    removedItems.push(litem);\r\n                }\r\n                else {\r\n                    addedItems.splice(rindex, 1);\r\n                    var diff = this_1.getDifference(litem, ritem, name, keyExtractors);\r\n                    if (diff.changeType === DiffType.Unchanged) {\r\n                        unchangedItems.push(ritem);\r\n                    }\r\n                    else {\r\n                        changedItems.push(diff);\r\n                    }\r\n                }\r\n            };\r\n            var this_1 = this;\r\n            for (var lindex = 0; lindex < leftArray.length; lindex++) {\r\n                _loop_1(lindex);\r\n            }\r\n            ;\r\n        }\r\n        else {\r\n            // we're using full object matching\r\n            for (var lindex = 0; lindex < leftArray.length; lindex++) {\r\n                var left = leftArray[lindex];\r\n                var found = false;\r\n                for (var rindex = 0; rindex < addedItems.length; rindex++) {\r\n                    var right = addedItems[rindex];\r\n                    if (this.getDifference(left, right, name, keyExtractors).changeType === DiffType.Unchanged) {\r\n                        unchangedItems.push(right);\r\n                        addedItems.splice(rindex, 1);\r\n                        found = true;\r\n                        break;\r\n                    }\r\n                }\r\n                if (!found) {\r\n                    removedItems.push(left);\r\n                }\r\n            }\r\n        }\r\n        var changeType = DiffType.Unchanged;\r\n        if (addedItems.length !== 0) {\r\n            changeType = changeType | DiffType.Added;\r\n        }\r\n        if (removedItems.length !== 0) {\r\n            changeType = changeType | DiffType.Removed;\r\n        }\r\n        if (changedItems.length !== 0) {\r\n            changeType = changeType | DiffType.Modified;\r\n        }\r\n        return {\r\n            oldValue: leftArray,\r\n            newValue: rightArray,\r\n            addedItems: addedItems,\r\n            removedItems: removedItems,\r\n            unchangedItems: unchangedItems,\r\n            changedItems: changedItems,\r\n            changeType: changeType\r\n        };\r\n    };\r\n    return GenericDiff;\r\n}());","mutatedLines":"var GenericDiff = (function () {\n}());"}